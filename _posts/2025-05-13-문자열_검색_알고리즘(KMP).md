---
title: "[Java/ì•Œê³ ë¦¬ì¦˜] ë¬¸ìì—´ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ - KMP"
date: 2025-05-13 12:32:43 +09:00
categories: [Java, String, ì•Œê³ ë¦¬ì¦˜]
tags: [
    Java,
    algorithm,
    ì•Œê³ ë¦¬ì¦˜,
    String,
    LPS,
    KMP,
    ë¬¸ìì—´,
    contains,
]
---

# ì„œë¡ 

ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œë¥¼ í’€ë©´ì„œ í•„ìš”í•œ íš¨ìœ¨ì ì¸ ë¬¸ìì—´ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ì„œ ê³µë¶€í•´ë³´ê³ , ê¹Šê²Œ ì´í•´í•´ë³´ë ¤ê³  í•œë‹¤.

<br>
<br>

# ì¼ë°˜ì ì¸ ë¬¸ìì—´ ê²€ìƒ‰

> ì¼ë°˜ì ì¸ ë¬¸ìì—´ ê²€ìƒ‰ì€ 'NaÃ¯ve String Search'ë¼ê³  ì¹­í•˜ëŠ”ë°, ì•„ë˜ ì½”ë“œì²˜ëŸ¼ ê²€ìƒ‰ ëŒ€ìƒê³¼ ëŒ€ìƒ íŒ¨í„´ì„ ë‘ê³  ë¬¸ìì—´ì˜ ì¸ë±ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ (0ë¶€í„° ì „ì²´ ê¸¸ì´ - íŒ¨í„´ì˜ ê¸¸ì´ê¹Œì§€) íŒ¨í„´ê³¼ ë˜‘ê°™ì€ ì§€ ëŒ€ì…í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì°¾ëŠ”ë‹¤.  
> ì´ ë°©ì‹ì€ ìµœì•…ì˜ ê²½ìš° O(N*M)ì˜ ì‹œê°„ë³µì¡ë„ê°€ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì— **íš¨ìœ¨ì ì´ì§€ ëª»í•˜ë‹¤.**

```java
public class PatternFinder {
    public static void main(String[] args) {
        String targetString = "hello hello hello hellgate";
        String pattern = "hell";

        findPattern(targetString, pattern);
    }

    public static void findPattern(String targetString, String pattern) {
        int targetStringSize = targetString.length();
        int patternSize = pattern.length();
        boolean unmatchedFlag = true;

        System.out.println("Begin to find pattern \"" + pattern + "\" at target string \"" + targetString + "\"");

        for(int i=0;i<=targetStringSize - patternSize;i++){ //ë¬¸ìì—´ì˜ ì¸ë±ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ 0ë¶€í„° ì „ì²´ ê¸¸ì´ - íŒ¨í„´ì˜ ê¸¸ì´ê¹Œì§€ íŒ¨í„´ê³¼ ë¹„êµ
            int j = 0;
            for(;j<patternSize;j++){
                if(targetString.charAt(i + j) != pattern.charAt(j)){
                    break;
                }
            }

            if(j == patternSize){
                System.out.println("Pattern \"" + pattern + "\" matched at " + (i + 1) + " ~ " + (i + patternSize));
                unmatchedFlag = false;
            }
        }

        if(unmatchedFlag){
            System.out.println("Pattern unmatched");
        }
    }
}
```

<br>
<br>

# ì¡°ê¸ˆ ë” íš¨ìœ¨ì ì¸ ë¬¸ìì—´ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ì€ ì—†ì„ê¹Œ?

> KMP ì•Œê³ ë¦¬ì¦˜(Knuthâ€“Morrisâ€“Pratt algorithm)ì´ ë¬¸ìì—´ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ ì¤‘ ì¤€ë¹„ ê³¼ì •ì„ ì„ í˜•ìœ¼ë¡œ ì§„í–‰í•  ìˆ˜ ìˆê³  ì‹¤íŒ¨ í•¨ìˆ˜ ë°°ì—´ (í˜¹ì€ LPS, pi ë°°ì—´)ë¡œ O(íŒ¨í„´ì˜ ê¸¸ì´ M)ì˜ ë©”ëª¨ë¦¬ë§Œ ì¶”ê°€ì ìœ¼ë¡œ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ê³µê°„ì ìœ¼ë¡œë„ íš¨ìœ¨ì ì´ë‹¤.  
> KMPëŠ” Knuthâ€“Morrisâ€“Pratt ì„¸ ì‚¬ëŒì´ ê³ ì•ˆí•œ ì•Œê³ ë¦¬ì¦˜ì´ê¸° ë•Œë¬¸ì— ì´ë¦„ì˜ ì•ê¸€ìë¥¼ ë”°ì„œ ì§€ì–´ì¡Œê³ , ë¬¸ìì—´ì˜ ê¸¸ì´ N, íŒ¨í„´ì˜ ê¸¸ì´ Mì—ì„œ O(N+M)ì˜ ì‹œê°„ë³µì¡ë„ë¡œ ëŒ€ë¶€ë¶„ ì–¸ì–´ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë¬¸ìì—´ ê²€ìƒ‰ í•¨ìˆ˜ì— ë¹„í•´ íš¨ìœ¨ì ì´ë‹¤.

<br>
<br>

## KMP ì•Œê³ ë¦¬ì¦˜

> KMP ì•Œê³ ë¦¬ì¦˜ì˜ í•µì‹¬ì€ ì ‘ë‘ì‚¬(Prefix) ì ‘ë¯¸ì‚¬(Suffix) ê°œë…ì„ í™œìš©í•´ì„œ "ë°˜ë³µë˜ëŠ” ì—°ì‚°ì„ ì–¼ë§ˆë‚˜ ê±´ë„ˆë›¸ ìˆ˜ ìˆëŠ”ì§€"ì— ì§‘ì¤‘í•´ì„œ íš¨ìœ¨ì„±ì„ ë†’ì´ëŠ” ê²ƒì´ë‹¤.

```java
String str = "ABCDABCEZ";
String pattern = "ABCDABA";
```

ìœ„ `str`ë¬¸ìì—´ì—ì„œ `pattern` ì„ ì°¾ëŠ”ë‹¤ê³  í•  ë•Œë¥¼ ê°€ì •í•´ë³¸ë‹¤.

| A   | B   | C   | D   | A   | B   | C     | E   | Z   |
| --- | --- | --- | --- | --- | --- | ----- | --- | --- |
| A   | B   | C   | D   | A   | B   | **A** |     |     |

ì—ì„œ "ABCDAB"ê¹Œì§€ëŠ” ê°™ì§€ë§Œ, ë§ˆì§€ë§‰ ë¬¸ì "C"ì™€ "A"ê°€ ë‹¤ë¦„ì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.

| A   | B   | C   | D   | A   | B   | C   | E   | Z   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
|     | A   | B   | C   | D   | A   | B   | A   |     |

ì—¬ê¸°ì—ì„œ ì¼ë°˜ì ì¸ brute-forceë¼ë©´ ë°”ë¡œ ë‹¤ìŒ ì¸ë±ìŠ¤ë¶€í„° íŒ¨í„´ì„ ë¹„êµí•˜ê² ì§€ë§Œ, ì•ì—ì„œëŠ” "C"ì™€ "A"ê°€ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒê³¼ ë³„ê°œë¡œ "ABCDAB"ê°€ ê°™ë‹¤ëŠ” ì ë„ ì•Œ ìˆ˜ ìˆë‹¤.

| A     | B     | C     | D     | A     | B     | C   | E   | Z   |
| ----- | ----- | ----- | ----- | ----- | ----- | --- | --- | --- |
| **A** | **B** | **C** | **D** | **A** | **B** | A   |     |     |

ì§€ê¸ˆê¹Œì§€ ê°™ì€ ë¬¸ìì—´ "ABCDAB" ì¤‘ íŒ¨í„´ ë‚´ ì ‘ë‘ì‚¬ì™€ ì ‘ë¯¸ì‚¬ê°€ ì¼ì¹˜í•˜ë©´ì„œ ê·¸ ê¸¸ì´ê°€ ìµœëŒ€ì¸ ë¶€ë¶„ì„ ë³´ë©´ "AB"ë‹¤. í˜„ì¬ íŒ¨í„´ì—ì„œ ì ‘ë¯¸ì‚¬ë¡œ ë³´ê³  ìˆëŠ” "AB" ë¶€ë¶„ì„, ë‹¤ì‹œ íƒìƒ‰í•  ë•Œì—ëŠ” ì ‘ë‘ì‚¬ë¡œ ë°”ë¼ë³´ê³  í•´ë‹¹ ë¶€ë¶„ë¶€í„° ë‹¤ì‹œ ì‹œì‘í•˜ë©´ì„œ ê²€ìƒ‰í•œë‹¤.

| A   | B   | C   | D   | A     | B     | C   | E   | Z   |     |     |     |
| --- | --- | --- | --- | ----- | ----- | --- | --- | --- | --- | --- | --- |
|     |     |     |     | **A** | **B** | C   | D   | A   | B   | A   |     |

íŒ¨í„´ì˜ ì ‘ë¯¸ì‚¬ ìœ„ì¹˜ë¥¼ ì ‘ë‘ì‚¬ ìœ„ì¹˜ë¡œ í•´ì„œ ë‹¤ìŒ "AB"ë¡œ ê±´ë„ˆë›°ë©´ì„œ íƒìƒ‰í•œë‹¤ë©´ íš¨ìœ¨ì ìœ¼ë¡œ íƒìƒ‰í•  ìˆ˜ ìˆë‹¤. ì´ íš¨ìœ¨ì„±ì— ì„ ìœ„í•´ ì ‘ë‘ì‚¬, ì ‘ë¯¸ì‚¬ì— ì§‘ì¤‘ í•´ì•¼í•œë‹¤.

<br>
<br>

# KMP ì•Œê³ ë¦¬ì¦˜ ë‚´ LPS ë°°ì—´

> LPSëŠ” Longest Prefix which is also Suffixì˜ ì¤„ì„ë§ì´ë‹¤. ì ‘ë‘ì‚¬ì´ë©´ì„œ ì ‘ë¯¸ì‚¬ì¸ ê¸°ì¤€ ë¬¸ìì—´ê³¼ ê°™ì§€ ì•Šìœ¼ë©´ì„œ, ê°€ì¥ ê¸´ ë¬¸ìì—´ì˜ ê¸¸ì´ ê°’ì„ ë‚˜íƒ€ë‚¸ë‹¤. ì´ ê°’ì€ ìœ„ì˜ ë¡œì§ì—ì„œ ë³¸ ê²ƒì²˜ëŸ¼ KMP ì•Œê³ ë¦¬ì¦˜ ë‚´ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ í•œë‹¤.

<br>

ì•„ë˜ì— ì˜ˆì‹œë¥¼ ë“¤ë©´,

```text
Input : s = â€œaabcdaabcâ€
Output : 4
ì„¤ëª… : ë¬¸ìì—´ "aabc"ëŠ” s ë¬¸ìì—´ì˜ ì ‘ë‘ì‚¬ì´ë©´ì„œ ì ‘ë¯¸ì‚¬ì´ê³ , ê°€ì¥ ê¸´ ë¬¸ìì—´ì˜ ê¸¸ì´ëŠ” 4ì´ë‹¤.


Input : s = â€œabababâ€
Output : 4
ì„¤ëª… : ë¬¸ìì—´ "abab"ëŠ” s ë¬¸ìì—´ì˜ ì ‘ë‘ì‚¬ì´ë©´ì„œ ì ‘ë¯¸ì‚¬ì´ê³ , ê°€ì¥ ê¸´ ë¬¸ìì—´ì˜ ê¸¸ì´ëŠ” 4ì´ë‹¤. ì—¬ê¸°ì—ì„œ "ababab"ëŠ” ê¸°ì¤€ ë¬¸ìì—´ê³¼ ê°™ê¸° ë•Œë¬¸ì— LPSê°€ ë  ìˆ˜ ì—†ë‹¤.


Input : s = â€œaaaaâ€
Output : 3
ì„¤ëª… : ë¬¸ìì—´ "aaa"ëŠ” s ë¬¸ìì—´ì˜ ì ‘ë‘ì‚¬ì´ë©´ì„œ ì ‘ë¯¸ì‚¬ì´ê³ , ê°€ì¥ ê¸´ ë¬¸ìì—´ì˜ ê¸¸ì´ëŠ” 3ì´ë‹¤. ì—¬ê¸°ì—ì„œ "aaaa"ëŠ” ê¸°ì¤€ ë¬¸ìì—´ê³¼ ê°™ê¸° ë•Œë¬¸ì— LPSê°€ ë  ìˆ˜ ì—†ë‹¤.
```

<br>
<br>

# ë¬¸ìì—´ì—ì„œ LPSë¥¼ êµ¬í•˜ëŠ” ì½”ë“œ

```java
public class LPS {
    public static void main(String[] args) {
        String s = "aabcdaabc";
        int n = s.length();
        int len = 0; //ì ‘ë‘ì‚¬ì˜ ê¸¸ì´ë¥¼ í¬ì¸í„°ë¡œ í• ë‹¹
        int [] pi = new int[n]; //pi[i] = s.substring(0, i)ì˜ LPS ê°’

        for(int i=1;i<n;i++){
            while(len > 0 && s.charAt(i) != s.charAt(len)){
                len = pi[len - 1];
            }
            if(s.charAt(i) == s.charAt(len)){
                len++;
                pi[i] = len;
            }
        }

        System.out.println(Arrays.toString(pi));
    }
}
```

```text
# ì¶œë ¥ê°’
[0, 1, 0, 0, 0, 1, 2, 3, 4]
```

## ğŸ’¡ ì½”ë“œ ìš”ì•½

* `pi[i]`ë€?  
s.substring(0, i) êµ¬ê°„ì—ì„œ `ì ‘ë‘ì‚¬ == ì ‘ë¯¸ì‚¬`ì¸ ê°€ì¥ ê¸´ ë¬¸ìì—´ì˜ ê¸¸ì´ë¥¼ ì €ì¥í•œ ë°°ì—´ì´ë‹¤.
pi[i]ëŠ” ë¬¸ìì—´ s.substring(0, i)ì˜ LPS ê¸¸ì´ë¥¼ ì˜ë¯¸í•œë‹¤.

* len í¬ì¸í„°ì˜ ì˜ë¯¸  
í˜„ì¬ê¹Œì§€ ë§¤ì¹­ëœ ì ‘ë‘ì‚¬ì˜ ê¸¸ì´ë¥¼ ë‚˜íƒ€ë‚´ë©°, s.charAt(i)ì™€ ë¹„êµí•  s.charAt(len) ìœ„ì¹˜ë¥¼ ê°€ë¦¬í‚¨ë‹¤.

* ë¶ˆì¼ì¹˜ ì‹œ ì²˜ë¦¬ (while)  
ë¬¸ìê°€ ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ `len = pi[len - 1]`ë¡œ ëŒì•„ê°€ì„œ ë‹¤ìŒ ê°€ëŠ¥í•œ ì ‘ë‘ì‚¬ ìœ„ì¹˜ì—ì„œ ë‹¤ì‹œ ë¹„êµí•œë‹¤.

* ì¼ì¹˜ ì‹œ ì²˜ë¦¬ (if)  
ë¬¸ìê°€ ì¼ì¹˜í•˜ë©´ `len++;` í•˜ê³  pi[i]ì— ì €ì¥í•œë‹¤.

<br>
<br>

# LPS ë°°ì—´ì„ ì´ìš©í•œ KMP ì•Œê³ ë¦¬ì¦˜

```java
//íŒ¨í„´ì— ë§ëŠ” íšŸìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” kmp
public static int kmp(String origin, String pattern){
    int [] pi = getPi(pattern);
    int count = 0;
    int index = 0;

    for(int i=0;i<origin.length();i++) {
        while (index > 0 && origin.charAt(i) != pattern.charAt(index)){
            index = pi[index - 1];
        }
        if (origin.charAt(i) == pattern.charAt(index)) {
            if (index == pattern.length() - 1) {
                    count++;
                    index = pi[index];
            } else {
                index++;
            }
        }
    }

    return count;
}

public static boolean kmp(String origin, String pattern){
    int [] pi = getPi(pattern); // patternì˜ LPS ë°°ì—´
    int index = 0; // pattern ë‚´ì—ì„œ í˜„ì¬ ë¹„êµ ì¤‘ì¸ ìœ„ì¹˜

    for(int i=0;i<origin.length();i++){
        while(index > 0 && origin.charAt(i) != pattern.charAt(index)){
            index = pi[index - 1];
        }
        if(origin.charAt(i) == pattern.charAt(index)){
            if(index == pattern.length() - 1){
                return true;
            }else{
                index++;
            }
        }
    }

    return false;
}
```

ì•„ë˜ `str`ê³¼ `pattern`ì„ ì˜ˆì‹œë¡œ KMP ì•Œê³ ë¦¬ì¦˜ ìˆ˜í–‰ì„ ìˆœì„œëŒ€ë¡œ ë³´ì¸ë‹¤.

```java
String str = "ABCDABCDABAZ";
String pattern = "ABCDABA";
```

<br>

### íŒ¨í„´ ë¬¸ìì—´ì˜ LPS (pi ë°°ì—´)

| pattern | A   | B   | C   | D   | A   | B   | A   |
| ------- | --- | --- | --- | --- | --- | --- | --- |
| index   | 0   | 1   | 2   | 3   | 4   | 5   | 6   |
| LPS     | 0   | 0   | 0   | 0   | 1   | 2   | 1   |

<br>

### KMP ì½”ë“œ ë‚´ for ë¬¸ì˜ `i` ë³„ íë¦„í‘œ

| `i` (for ë¬¸ ì¸ë±ìŠ¤) | `origin.charAt(i)` | `pattern.charAt(index)` | `origin.charAt(i)` == `pattern.charAt(index)` | `index` ì´ë™ ì—°ì‚°                           | ë‹¤ìŒ `index` |
| ------------------- | ------------------ | ----------------------- | --------------------------------------------- | ------------------------------------------- | ------------ |
| 0                   | a                  | a                       | âœ…                                             | index++                                     | 1            |
| 1                   | b                  | b                       | âœ…                                             | index++                                     | 2            |
| 2                   | c                  | c                       | âœ…                                             | index++                                     | 3            |
| 3                   | d                  | d                       | âœ…                                             | index++                                     | 4            |
| 4                   | a                  | a                       | âœ…                                             | index++                                     | 5            |
| 5                   | b                  | b                       | âœ…                                             | index++                                     | 6            |
| 6                   | c                  | a                       | âŒ                                             | index = pi\[5] = 2 (ë˜ëŒì•„ê°)               | 2            |
| 6                   | c                  | c                       | âœ…                                             | index++                                     | 3            |
| 7                   | d                  | d                       | âœ…                                             | index++                                     | 4            |
| 8                   | a                  | a                       | âœ…                                             | index++                                     | 5            |
| 9                   | b                  | b                       | âœ…                                             | index++                                     | 6            |
| 10                  | a                  | a                       | âœ…                                             | index == pattern.length() - 1 â†’ return true | (ì¢…ë£Œ)       |

> `i` ê¸°ì¤€ 0~5ê¹Œì§€ íŒ¨í„´ ë¬¸ìì—´ê³¼ ì¼ì¹˜í•˜ë‹¤ê°€, 6ë²ˆì—ì„œ ë¬¸ìì—´ì´ ì¼ì¹˜í•˜ì§€ ì•Šì•„ì„œ ì¸ë±ìŠ¤ë¥¼ `pi[index - 1]` ì¸ 2ë¡œ ë˜ëŒì•„ê°„ í›„ì— ë‹¤ì‹œ 6ë²ˆ ì¸ë±ìŠ¤ì— ëŒ€í•œ ì¼ì¹˜ ì—¬ë¶€ë¥¼ ê³„ì† íŒë‹¨í•´ì„œ ë¬¸ìì—´ì„ ì°¾ì„ ìˆ˜ ìˆì—ˆë‹¤.

## ê²°ë¡ 

ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ ì¤‘ì— ë¬¸ìì—´ ê²€ìƒ‰ ë¡œì§ì´ í•„ìš”í•  ì¼ì´ ë§ì€ë° `String.contains()` ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ë©´ ì‹œê°„ ì´ˆê³¼ê°€ ë°œìƒí•˜ëŠ” ê²½ìš°ê°€ ë”ëŸ¬ ìˆì—ˆë‹¤. ì´ì „ SSAFY ë•Œë¶€í„° íš¨ìœ¨ì ì¸ ë¬¸ìì—´ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ KMPë¥¼ ë°°ì›Œì™”ì§€ë§Œ ì •ë¦¬í•˜ë©´ì„œ ì œëŒ€ë¡œ ê¹Šê²Œ í•™ìŠµí•  ìˆ˜ ìˆì—ˆë‹¤. ë‹¤ìŒìœ¼ë¡œëŠ” Javaì˜ `String.contains()`ì— ëŒ€í•´ ì¡°ê¸ˆ ë” ì•Œì•„ë³¼ ì˜ˆì •ì´ë‹¤.

## ì¶œì²˜

* [ë¬¸ìì—´ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ - ë‚˜ë¬´ìœ„í‚¤](https://namu.wiki/w/%EB%AC%B8%EC%9E%90%EC%97%B4%20%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98#:~:text=2.-,%EB%AC%B8%EC%9E%90%EC%97%B4%20%EA%B2%80%EC%83%89%20%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98,-%5B%ED%8E%B8%EC%A7%91%5D)

* [Longest Prefix also Suffix](https://www.geeksforgeeks.org/longest-prefix-also-suffix/)
